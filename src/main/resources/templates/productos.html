<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - Neita's Barber Shop</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .productos-page {
            padding: 60px 0;
            min-height: 100vh;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .page-header h1 {
            font-size: 3rem;
            color: var(--color-secondary);
        }
        
        .productos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }
        
        .producto-card {
            background-color: var(--color-light);
            padding: 25px;
            border: 2px solid var(--color-border);
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .producto-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .producto-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }
        
        .producto-card h3 {
            color: var(--color-secondary);
            margin-bottom: 10px;
        }
        
        .producto-descripcion {
            color: var(--color-text);
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .producto-precio {
            font-size: 1.5rem;
            color: var(--color-primary);
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .producto-stock {
            color: #28a745;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .btn-comprar {
            padding: 10px 25px;
            background-color: var(--color-primary);
            color: var(--color-secondary);
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-comprar:hover {
            background-color: var(--color-accent);
            color: var(--color-light);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--color-accent);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <h1>Neita's</h1>
                    <span>BARBER SHOP</span>
                </div>
                <ul class="nav-menu">
                    <li><a href="/">Inicio</a></li>
                    <li><a href="/servicios">Servicios</a></li>
                    <li><a href="/profesionales">Barberos</a></li>
                    <li><a href="/galeria">GalerÃ­a</a></li>
                    <li><a href="/productos">Productos</a></li>
                    <li><a href="/login" class="btn-login" id="loginBtn">Iniciar SesiÃ³n</a></li>
                    <li><a href="/registro" class="btn-registro" id="registroBtn">Registrarse</a></li>
                    <li><a href="#" class="btn-registro" id="logoutBtn" style="display:none;" onclick="logout()">Cerrar SesiÃ³n</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="productos-page">
        <div class="container">
            <div class="page-header">
                <h1>Nuestros Productos</h1>
                <p>Productos profesionales para el cuidado personal</p>
            </div>
            
            <div id="loading" class="loading">Cargando productos...</div>
            <div id="productosGrid" class="productos-grid"></div>
        </div>
    </section>

    <script th:src="@{/js/main.js}"></script>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const usuarioData = localStorage.getItem('usuario');
            if (usuarioData) {
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('registroBtn').style.display = 'none';
                document.getElementById('logoutBtn').style.display = 'block';
            }
            
            cargarProductos();
        });
        
        async function cargarProductos() {
            try {
                const response = await fetch('http://localhost:8088/api/productos/disponibles');
                const productos = await response.json();
                
                document.getElementById('loading').style.display = 'none';
                const grid = document.getElementById('productosGrid');
                grid.innerHTML = '';
                
                if (productos.length === 0) {
                    // Mostrar productos de ejemplo
                    mostrarProductosEjemplo(grid);
                    return;
                }
                
                productos.forEach(producto => {
                    const card = crearCardProducto(producto);
                    grid.appendChild(card);
                });
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                const grid = document.getElementById('productosGrid');
                mostrarProductosEjemplo(grid);
            }
        }
        
        function mostrarProductosEjemplo(grid) {
            const productosEjemplo = [
                { nombre: 'Cera para Cabello', descripcion: 'FijaciÃ³n fuerte, acabado natural', precio: 35000, stock: 15, icon: 'ðŸ’ˆ' },
                { nombre: 'Aceite para Barba', descripcion: 'Hidrata y suaviza la barba', precio: 28000, stock: 20, icon: 'ðŸ§´' },
                { nombre: 'Shampoo Premium', descripcion: 'Limpieza profunda y nutriciÃ³n', precio: 32000, stock: 12, icon: 'ðŸ§¼' },
                { nombre: 'Navaja de Afeitar', descripcion: 'Acero inoxidable de alta calidad', precio: 45000, stock: 8, icon: 'ðŸª’' },
                { nombre: 'Peine Profesional', descripcion: 'Resistente al calor', precio: 18000, stock: 25, icon: 'ðŸ’‡' },
                { nombre: 'Gel Fijador', descripcion: 'FijaciÃ³n extra fuerte', precio: 25000, stock: 18, icon: 'âœ¨' }
            ];
            
            productosEjemplo.forEach(prod => {
                const card = document.createElement('div');
                card.className = 'producto-card';
                card.innerHTML = `
                    <div class="producto-icon">${prod.icon}</div>
                    <h3>${prod.nombre}</h3>
                    <p class="producto-descripcion">${prod.descripcion}</p>
                    <div class="producto-precio">$${prod.precio.toLocaleString('es-CO')}</div>
                    <div class="producto-stock">âœ“ En stock (${prod.stock} unidades)</div>
                    <button class="btn-comprar" onclick="alert('FunciÃ³n de compra prÃ³ximamente')">Comprar</button>
                `;
                grid.appendChild(card);
            });
        }
        
        function crearCardProducto(producto) {
            const card = document.createElement('div');
            card.className = 'producto-card';
            card.innerHTML = `
                <div class="producto-icon">ðŸ“¦</div>
                <h3>${producto.nombre}</h3>
                <p class="producto-descripcion">${producto.descripcion || ''}</p>
                <div class="producto-precio">$${producto.precio.toLocaleString('es-CO')}</div>
                <div class="producto-stock">âœ“ En stock (${producto.stock} unidades)</div>
                <button class="btn-comprar" onclick="alert('FunciÃ³n de compra prÃ³ximamente')">Comprar</button>
            `;
            return card;
        }
        
        function logout() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('usuario');
            window.location.href = '/';
        }
    </script>
</body>
</html>
